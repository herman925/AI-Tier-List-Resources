<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/modal-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>小赫的AI星辰榜</title>
    <!-- Include marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <h1><span class="star-icon">✨</span> 小赫的AI星辰榜 <span class="star-icon">✨</span></h1>
        <p>為你的 AI 工具們評定星級！</p>
        <div class="controls">
            <!-- Language Switch -->
            <div class="language-switch">
                <button id="lang-zh-btn" class="lang-btn active-lang" data-lang="zh">中</button>
                <button id="lang-en-btn" class="lang-btn" data-lang="en">EN</button>
            </div>
        </div>
    </header>

    <main class="container">
        <section id="nebula-candidate-area" class="ai-pool">
            <h2><span class="icon">🌌</span> 星雲候補區 (AI Item Pool)</h2>
            <div id="ai-items" class="item-grid">
                <!-- AI items will be loaded here by JavaScript -->
                <!-- Example structure: -->
                <!-- <div class="ai-item" draggable="true" data-id="chatgpt4">
                    <img src="icons/chatgpt.png" alt="ChatGPT-4 Logo">
                    <span>ChatGPT-4</span>
                </div> -->
            </div>
            <button id="add-custom-ai-btn" class="btn-secondary"><span class="icon">➕</span> 新增自訂 AI</button>
        </section>

        <section id="star-tier-division" class="tier-list">
            <h2 data-translate="aiToolTierListTitle">AI Tool Tier List</h2>
            <div id="tier-list-container">
                <!-- Tiers will be loaded here by tierManagement.js -->
            </div>
            <div class="tier-controls">
                <button id="add-tier-btn" class="btn-secondary"><span class="icon">➕</span> 新增層級</button>
                <button id="remove-tier-btn" class="btn-secondary"><span class="icon">➖</span> 移除層級</button>
            </div>
        </section>

        <section id="controls" class="action-buttons">
            <button id="save-chart-btn" class="btn-primary"><span class="icon">💾</span> 封存星圖 (Save)</button>
            <button id="share-chart-btn" class="btn-primary"><span class="icon">🔗</span> 分享星軌 (Share)</button>
            <button id="export-csv-button" class="btn-primary"><span class="icon">📄</span> <span data-lang-key="exportCsvButtonLabel">Export Placements (CSV)</span></button>
            <button id="reset-chart-btn" class="btn-danger"><span class="icon">🔄</span> 重設榜單 (Reset)</button>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 小赫的AI星辰榜. All rights reserved.</p>
    </footer>

    <!-- Modal for adding custom AI (example) -->
    <div id="add-ai-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>新增自訂 AI</h3>
            <label for="custom-ai-name">名稱:</label>
            <input type="text" id="custom-ai-name" name="custom-ai-name"><br><br>
            <label for="custom-ai-icon">圖標 URL (可選):</label>
            <input type="text" id="custom-ai-icon" name="custom-ai-icon"><br><br>
            <button id="confirm-add-ai-btn" class="btn-primary">確認新增</button>
        </div>
    </div>
    
    <!-- Edit AI Item Modal -->
    <div id="editAIModal" class="modal">
        <div class="modal-content edit-modal-content"> 
            <span class="close-button" id="closeEditModal">&times;</span>
            <h2>Edit AI Tool</h2>

            <!-- Moved Language Switch to Top -->
            <div class="language-switch" style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #444;">
                <label style="margin-bottom: 0; margin-right: 10px;">Display Language:</label>
                <button type="button" id="langSwitchEN" class="lang-button">EN</button>
                <button type="button" id="langSwitchZH" class="lang-button active">ZH</button> 
            </div>

            <form id="editAIForm">
                <input type="hidden" id="editItemId">
                
                <!-- Bilingual Name -->
                <!-- Edit Mode Name Inputs -->
                <div class="form-field-group edit-mode-element"> 
                    <div id="nameENContainer">
                        <label for="editItemNameEN">Name (English):</label>
                        <input type="text" id="editItemNameEN" required>
                    </div>
                    <div id="nameZHContainer">
                        <label for="editItemNameZH">AI工具名稱：</label>
                        <input type="text" id="editItemNameZH" required>
                    </div>
                </div>
                <!-- Read Only Name/Icon Display - Label/Value Pairs -->
                <div class="read-only-section read-only-element">
                    <!-- Chinese Name Pair -->
                    <div id="readOnlyPairZH" class="read-only-pair">
                        <label>AI工具名稱：</label>
                        <div class="value-container">
                            <span id="displayNameZH"></span>
                        </div>
                    </div>
                    <!-- English Name Pair -->
                    <div id="readOnlyPairEN" class="read-only-pair">
                        <label>Tool Name:</label>
                        <div class="value-container">
                            <span id="displayNameEN"></span>
                        </div>
                    </div>
                    <!-- Icon URL Pair -->
                    <div id="readOnlyPairIcon" class="read-only-pair">
                        <label>Icon</label>
                        <div class="value-container">
                            <span id="displayIconURL"></span>
                        </div>
                    </div>
                </div>

                <!-- Icon -->
                <div class="form-field-group edit-mode-element">
                    <label for="editItemIcon">圖示</label>
                    <input type="url" id="editItemIcon">
                </div>

                <!-- Description Fields (Inputs hidden in read-only mode) -->
                <div id="descriptionFields" class="edit-mode-element"> 
                    <div class="description-field edit-mode-element" id="descENContainer">
                        <label for="editItemDescriptionEN">Tool Description</label>
                        <textarea id="editItemDescriptionEN" rows="5"></textarea>
                    </div>
                    <div class="description-field edit-mode-element" id="descZHContainer"> 
                        <label for="editItemDescriptionZH">工具簡介編輯</label>
                        <textarea id="editItemDescriptionZH" rows="5"></textarea>
                    </div>
                </div>

                <!-- Markdown Preview (Always visible, but content updates) -->
                <div class="markdown-preview-container">
                    <label>工具簡介</label> 
                    <div id="markdownPreview" class="markdown-preview"></div>
                </div>

                <!-- Modal Actions -->
                <div class="modal-actions">
                    <button type="button" id="editModeBtn" class="btn-secondary read-only-element">Edit</button> 
                    <button type="submit" class="btn-primary edit-mode-element">Save Changes</button>
                    <button type="button" id="cancelEdit" class="btn-secondary edit-mode-element">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Load JavaScript modules -->
    <script type="module" src="js/languageManager.js"></script>
    <script type="module" src="js/exportManager.js"></script> <!-- Ensure this is type module -->
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/tierManagement.js"></script>
</body>
</html>
